import {describe, expect, test} from 'bun:test'
import type {Transaction} from '@wingriders/cab/dappConnector'
import {
  type CborizedTxStructured,
  ShelleyTransactionStructured,
  cborizeTxWitnesses,
} from '@wingriders/cab/ledger/transaction'
import {reverseTx, reverseVKeyWitnesses} from '@wingriders/cab/wallet/connector'
import {encode} from 'borc'
import {parseTransactionCbor} from '../../src/transaction/parseCbor'

const cborizeTx = (tx: Transaction): CborizedTxStructured => {
  // txAux inputs will have wrong address, coins and token bundle
  // but encoding ignores those, it just uses tx hash and output index (which stay correct)
  const txAux = reverseTx(tx, [])
  const witnessSet = cborizeTxWitnesses({
    shelleyWitnesses: reverseVKeyWitnesses(tx.witnessSet.vKeyWitnesses ?? []),
    byronWitnesses: [], // not supported
    scripts: txAux.scripts,
    datums: txAux.datums,
    redeemers: txAux.redeemers,
    inputs: txAux.inputs,
    mint: txAux.mint,
  })
  return ShelleyTransactionStructured(txAux, witnessSet)
}

const transactions = [
  '84a600818258204def8e217da419210a43c58fe6627a17b09e0ae58a6c4dd31d35422b85152384010182a300581d70c25f7962dcbb4f0837de40ab625f5df72a01f23a61eb4021ba6e8ad0011a004c4b40028201d81858efd8799f1a001e8480d8799fd8799f581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870ffd8799fd8799fd8799f581c2966ddf1dacf046d52483389174713c212a3b549370f996066569251ffffffffd8799fd8799f581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870ffd8799fd8799fd8799f581c2966ddf1dacf046d52483389174713c212a3b549370f996066569251ffffffff80d879801b000001af172aab7c4040581c659ab0b5658687c2e74cd10dba8244015b713bf503b90557769d77a74a57696e67526964657273d8799fd879801a0004d536ff0101ff82583900b47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a8702966ddf1dacf046d52483389174713c212a3b549370f9960665692511b000000055e68a25a021a0002cd4d031a0441d59307582052192b2492f2fab4624f9cbce1209214ee442e42f83fe61a4d021b857c5aefb1081a0441c783a1008182582023db24dd4ec11a54e462d39ced6c1541ed727f8b6d2fe775cf6135f67f79d5eb5840161ad25184d477e72a75c5f1efeb28b013d5d2c6122443cc51a22aea4f5ed79fb427283b73a9a9dc24d541098765e20c9290fff7c2b4adb2cd5dbfcc2246a005f5a11902a2a1636d7367817357696e675269646572733a2056322053776170',
  '84a700828258206f092e0109285f36614d6e6db3c5fce865b76f782c106edcee9fc7075d3ef373008258206f092e0109285f36614d6e6db3c5fce865b76f782c106edcee9fc7075d3ef37301018283583910b429738bd6cc58b5c7932d001aa2bd05cfea47020a556c8c753d44362966ddf1dacf046d52483389174713c212a3b549370f9960665692511a004c4b405820963c51885976235c113d9a763fd2a3d11277d276a764d3a29661495f0a4264ed82583900b47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a8702966ddf1dacf046d52483389174713c212a3b549370f9960665692511b000000055e0c558c021a0002db39031a0441f23807582005b6dc4366e00a898971405b2876e3e9dc84877990a1b76c69107ab825b884bd081a0441e4280b582026ba4bb7d9ee92ac73235d9bb69fb16d104357c9866b1321a1fbd2908b78f74ca2008182582023db24dd4ec11a54e462d39ced6c1541ed727f8b6d2fe775cf6135f67f79d5eb5840b27e899f9ae3abcad69620ee43ced0d3b72ba3f292a4dcb264701eaa096401f571d6a1f7b537954ef0921982aeb38e135806e89268e96fa45bf56dcb500f46080481d8799fd8799fd8799fd8799f581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a870ffd8799fd8799fd8799f581c2966ddf1dacf046d52483389174713c212a3b549370f996066569251ffffffff581cb47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a8701b000001af179a8c9ed8799fd8799f4040ffd8799f581c659ab0b5658687c2e74cd10dba8244015b713bf503b90557769d77a74a57696e67526964657273ffffffd8799fd879801a000e6ff8fffff5a11902a2a1636d7367817357696e675269646572733a2056312053776170',
  '84a6008282582086e07cd65e23e3864430abe403c03d622e4127896d8d07573d215705e27ad1d8181e825820c128481aec7bc04dfa1f7414b7af545fc0c673c9b9ffc34f20c77b8cf32ad47c01018283581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a002dc6c0a1581cc0ee29a85b13209423b10447d3c2e6a50641a15c57770e27cb9d5073a14a57696e675269646572731a5b7cb30b582026df0a68d4457fa9af8d7b7be81edd310de351790117b3b7fc145273c85df60e82583901e1452dc393844247141a353d0869959891a9e845c0854cd0491f9abf5f4bcc1191bea46272fe2fde8b3182b5cf3fbee0b67772190b889aa51a003993f8021a000400c90b58208fd2d614f5019a1279badb78f43b4931cda9caabf88a42cfdb2d99abe0c291ac0d8182582009af1d858e540c8dc01e858610934d4dab594dc689f0119e1ef1338eead6adc9040e81581ce1452dc393844247141a353d0869959891a9e845c0854cd0491f9abfa303815906bd5906ba0100003232323232323232323232323232323232323232323232323232323232323232323232323232323232332222232533302a001149858c8c94ccc0accdc3800a405026602c00a0062a66605666e1c005202a1323333009375a605c6604c6ea0dd6981700081299ba548008094018010c0bc00854ccc0accdc3800a405826666010646eb4c0b8004cc094dd41bad3300d00e302f0020243374a90010120028018a99981599b87001480b84c8c8cccc028dd6981780099ba548000cc09cc0bcc0b800409801c014cc098dd41bad302e0013302637526eb8cc03803cc0b4004094c0bc00854ccc0accdc3800a406026464666444646464646464646464a6604a66ebc014c0ec01854cc094cdd799181e181e800981d80219181e181e800981d8010a998129919b8848000ccc07c004058054c8dd5981e181d981e80099181e181d800981e198110058038a9981299baf301d303b303a003301d303b303a0011332232332303a22533303d00114a22a660566006608200226004608000246464646466e24004ccc09801c010008dd698220011bae304400130253042002375c608400200266604644646466604e446607666ec0010cdd2a400066076608c00266076608a0020740040080026eacc108008c1080052f5bded8c00046eacc0ec00cdd5981d800981c800981d198100051bac30393038006303700130383037303600230333036303500430363301c006001375860680026068606600260660026eb4c0bc004dd698179817000802998131ba8375a605c0026604c6ea0dd698171816800812981780109980b00280198178009baa0024891c1c0d57fdad384c5192735d38e467629316ad06650dcd038d54aa15ed00488101410022223232323232323232323232323253330343370e900000109919299811191919299981c99b87480000084cc09cc0ec00401058c0f0008c0f0004dd5181c181c8040a9981119baf323039303a001303800b323039303a001303800a132323253330393370e9000001099baf3374a90001981980599819981d800998198050191980b804802899b8f3018303b303a303a00e005303c002303c00137540246eb0c0dc02cdd7181b0008b181b801181b8009baa30333032303200537586064606200c60626060606000460600026060010605e6602a0126eb0c0b800cc0b8cc02cc0b4c0b0010dd61816801980d9815800981500098159815000981500091198109129998120008b09919299981419b8f005375c002260580042600860520066058002601a60500020044646464a66604a66e1d20000021375c604e0022c605000460500026ea800488c8c8c94ccc094cdc3a400400426600c008604e0022c605000460500026ea800888cc078894ccc084004584c8c8c94ccc098cdd780300108008980298138021813981300118130009813181280080111299980f0008b099299980f800898118010b1810800a48100232323253330203370e9000001098110008b181180118118009baa001222333300437520040064666600a6ea4008dd5800bad14800052000223301922533301c00112250011533301e3375e6046604000200824460046048604400626004603e00200246466ec0c074004c074c070004c078dd50009180b111299980d000880109980199802001180f000980e80091299980c99b8800248000584cc00c008004c04c8894ccc064cdc3801240002603600226600666e040092002301a001223232323232323232323253330213370e90000010b0991919299981219b874800000854cc040cc048c098004c8dd61813980a000981398130068980c9980d180d9bae30260043301c20013758604c604a0182c604e004604e0026ea8c8c090c094004c08cc090030c090008c090004dd518101810800980f801180e800980f0009980a9bac301c0020013018301b301a002301b301a001301a0012233301600200100314a04602044a666026002294054ccc054cdd7980b8008018a511300230160012301330020012301230020012301130020012301030020012300f30020012300e300e00157464601044a666016002200c264a66601c60080022660100026006601e00426006601e004601e002446464646464a66602066e1d200000214a0266e3cdd71809000803980980118098009baa001300e300f001300d300e0012300622533300900110041330053003300d0013002300c0014bd702ba022330030010022300222533300500116153330073375e006646014601600260120022646014601260160026012002260046010002464600446600400400246004466004004002aae7c8c8c8c94ccc014cdc3a40040042600e0022c601000460100026ea80055cd2ba25742460046ea800555cf2ab9d010481d8799fd8799fd8799f581ce1452dc393844247141a353d0869959891a9e845c0854cd0491f9abfffd8799fd8799fd8799f581c5f4bcc1191bea46272fe2fde8b3182b5cf3fbee0b67772190b889aa5ffffffff4100d8799f581cc0ee29a85b13209423b10447d3c2e6a50641a15c57770e27cb9d50734a57696e67526964657273ffff0581840000d9050e9f00ff820000f5f6',
  '84a600828258207d17ca489a1bb99de4caf7f0e4e7e6f1b8bc050eb88b03dcd4a33649b0eab1f6078258209e0b917abcdf3bb82d2f3e447e930501f8ee7044dd99494be2f7f9dd347f228006018383581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a002dc6c0a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a15820213117b6a9d5f387a75a5721e30cfc5ce0b544a12ff8ad1adda83065ca18956f1b000000054b0421e258204aecabc28cd66123783faae9423a0bfadb0e6c5ed42f0e35c9ad6e054d11d047825839018acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72d1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ce1a004b93a4825839018acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72d1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ce821a00190e7ea4581c002954d012220494e078a25587a99e6c717d6854f1179517318492c7a1446241646101581c12d5f4fefe222d52a4fdcee56f4b272911d7c2202b068a08ebf53270a14449414d58193510581c63c2919618f27cd69583d8227f175e0e65209a9b13088dab6baa3e2ba14452574d5401581caf2e27f580f7f08e93190a81f72462f153026d06450924726645891ba144445249501a02c8ac64021a00042fe10b58208c3a6b1495f85e19986010c28ef965010be2c6b4b854030aaffcc7bb9919ef680d81825820012d2fc47ca0cce7f7a28480ceafa8106841ed5adc9541a854d261f529a7dbc7000e81581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72a303815906bd5906ba0100003232323232323232323232323232323232323232323232323232323232323232323232323232323232332222232533302a001149858c8c94ccc0accdc3800a405026602c00a0062a66605666e1c005202a1323333009375a605c6604c6ea0dd6981700081299ba548008094018010c0bc00854ccc0accdc3800a405826666010646eb4c0b8004cc094dd41bad3300d00e302f0020243374a90010120028018a99981599b87001480b84c8c8cccc028dd6981780099ba548000cc09cc0bcc0b800409801c014cc098dd41bad302e0013302637526eb8cc03803cc0b4004094c0bc00854ccc0accdc3800a406026464666444646464646464646464a6604a66ebc014c0ec01854cc094cdd799181e181e800981d80219181e181e800981d8010a998129919b8848000ccc07c004058054c8dd5981e181d981e80099181e181d800981e198110058038a9981299baf301d303b303a003301d303b303a0011332232332303a22533303d00114a22a660566006608200226004608000246464646466e24004ccc09801c010008dd698220011bae304400130253042002375c608400200266604644646466604e446607666ec0010cdd2a400066076608c00266076608a0020740040080026eacc108008c1080052f5bded8c00046eacc0ec00cdd5981d800981c800981d198100051bac30393038006303700130383037303600230333036303500430363301c006001375860680026068606600260660026eb4c0bc004dd698179817000802998131ba8375a605c0026604c6ea0dd698171816800812981780109980b00280198178009baa0024891c1c0d57fdad384c5192735d38e467629316ad06650dcd038d54aa15ed00488101410022223232323232323232323232323253330343370e900000109919299811191919299981c99b87480000084cc09cc0ec00401058c0f0008c0f0004dd5181c181c8040a9981119baf323039303a001303800b323039303a001303800a132323253330393370e9000001099baf3374a90001981980599819981d800998198050191980b804802899b8f3018303b303a303a00e005303c002303c00137540246eb0c0dc02cdd7181b0008b181b801181b8009baa30333032303200537586064606200c60626060606000460600026060010605e6602a0126eb0c0b800cc0b8cc02cc0b4c0b0010dd61816801980d9815800981500098159815000981500091198109129998120008b09919299981419b8f005375c002260580042600860520066058002601a60500020044646464a66604a66e1d20000021375c604e0022c605000460500026ea800488c8c8c94ccc094cdc3a400400426600c008604e0022c605000460500026ea800888cc078894ccc084004584c8c8c94ccc098cdd780300108008980298138021813981300118130009813181280080111299980f0008b099299980f800898118010b1810800a48100232323253330203370e9000001098110008b181180118118009baa001222333300437520040064666600a6ea4008dd5800bad14800052000223301922533301c00112250011533301e3375e6046604000200824460046048604400626004603e00200246466ec0c074004c074c070004c078dd50009180b111299980d000880109980199802001180f000980e80091299980c99b8800248000584cc00c008004c04c8894ccc064cdc3801240002603600226600666e040092002301a001223232323232323232323253330213370e90000010b0991919299981219b874800000854cc040cc048c098004c8dd61813980a000981398130068980c9980d180d9bae30260043301c20013758604c604a0182c604e004604e0026ea8c8c090c094004c08cc090030c090008c090004dd518101810800980f801180e800980f0009980a9bac301c0020013018301b301a002301b301a001301a0012233301600200100314a04602044a666026002294054ccc054cdd7980b8008018a511300230160012301330020012301230020012301130020012301030020012300f30020012300e300e00157464601044a666016002200c264a66601c60080022660100026006601e00426006601e004601e002446464646464a66602066e1d200000214a0266e3cdd71809000803980980118098009baa001300e300f001300d300e0012300622533300900110041330053003300d0013002300c0014bd702ba022330030010022300222533300500116153330073375e006646014601600260120022646014601260160026012002260046010002464600446600400400246004466004004002aae7c8c8c8c94ccc014cdc3a40040042600e0022c601000460100026ea80055cd2ba25742460046ea800555cf2ab9d010481d8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed7375820213117b6a9d5f387a75a5721e30cfc5ce0b544a12ff8ad1adda83065ca18956fffff0581840001d9050e9f00ff820000f5f6',
  '84a6008782582011a8c6e7c5093a837a57759b93506a1899c233d8d0a1c2124957987c400499c20682582012ff0ba17d0012d4e2dbfa8484e3a095a83972a0ee68bffa60065899dd92898200825820342883d546da2c5948bf68737499b8a9fb4c3dd6f03a0318aefd2e5cb083d5ac1282582088f0daea4b3029289e0b674dd9591d76dae545d48b3ee8c2c7d613cf2c96b894118258208e1e1ebfc4876cb0bf40a43f517c7e988d11fe1142c86e459c922521be18a24b00825820b8b82cb8627d2091ad265bdc163f97d360246cad59b7bfaf78f6fd84ff5de50b181d825820de23dac73dad85ccf8725816cffb0009f8524b3de99cd76d3800fccffef4fa06181a018883581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a15820e650ce568d1dc1ebfb9bfbd8c06982f3ea95a9959ddaefc783edd95134d2b3eb1a8dab133d5820377426ab7274b0b535b4d93d40b517479f194e331b98cbd14dec7405120e6bc983581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a158200bee3eb0b93c2a1e72cb7937b90eac382666bd34dc5971df83f5ee4112a86a161a3eaffa135820805af0a414210a0eee14fbd22dfeeb74d7cc3dc4e0a213d0d72739fa19fb89a583581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a15820e79dada966ab71401163d399134def8a608b31297e179782d796c76d434f8c571a3c5060735820c7a6c31e8b205f807cd6b2020d52f67b3189599311e8f9924e122c38bab9531b83581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a158204f0b13fa2716e773c279a0de67fe6fde1b665644e119f06589a6ae1e60c1d9c01a01406d26582002c8e983cc7150744fbec47bc5ed598cb81c557621785e2b4399bdcdff7812cc83581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a15820e3b382a85249ef92357e00bd42c088c69c1eac2a736ae2df34dd2b89de11de1a1a007d39a358204856aafbcb038fa46d8a644e4ce9a9dfd3dfe56fbef82d36698ea6192a45bee383581d710237cc313756ebb5bcfc2728f7bdc6a8047b471220a305aa373b278a821a003d0900a1581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737a15820213117b6a9d5f387a75a5721e30cfc5ce0b544a12ff8ad1adda83065ca18956f1b000000054b0421e258204aecabc28cd66123783faae9423a0bfadb0e6c5ed42f0e35c9ad6e054d11d047825839018acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72d1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ce1a09e7b36d825839018acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72d1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ce821a00178b44a3581c279c909f348e533da5808898f87f9a14bb2c3dfbbacccd631d927a3fa144534e454b1914f2581caf2e27f580f7f08e93190a81f72462f153026d06450924726645891ba144445249501a02a2e859581cc0ee29a85b13209423b10447d3c2e6a50641a15c57770e27cb9d5073a14a57696e675269646572731b000000010533b0a8021a000558310b5820f56fdacef63011494e6f3587ea66b47a4b8229dec102cd98018cb7ceefc188370d81825820012d2fc47ca0cce7f7a28480ceafa8106841ed5adc9541a854d261f529a7dbc7000e81581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72a303815906bd5906ba0100003232323232323232323232323232323232323232323232323232323232323232323232323232323232332222232533302a001149858c8c94ccc0accdc3800a405026602c00a0062a66605666e1c005202a1323333009375a605c6604c6ea0dd6981700081299ba548008094018010c0bc00854ccc0accdc3800a405826666010646eb4c0b8004cc094dd41bad3300d00e302f0020243374a90010120028018a99981599b87001480b84c8c8cccc028dd6981780099ba548000cc09cc0bcc0b800409801c014cc098dd41bad302e0013302637526eb8cc03803cc0b4004094c0bc00854ccc0accdc3800a406026464666444646464646464646464a6604a66ebc014c0ec01854cc094cdd799181e181e800981d80219181e181e800981d8010a998129919b8848000ccc07c004058054c8dd5981e181d981e80099181e181d800981e198110058038a9981299baf301d303b303a003301d303b303a0011332232332303a22533303d00114a22a660566006608200226004608000246464646466e24004ccc09801c010008dd698220011bae304400130253042002375c608400200266604644646466604e446607666ec0010cdd2a400066076608c00266076608a0020740040080026eacc108008c1080052f5bded8c00046eacc0ec00cdd5981d800981c800981d198100051bac30393038006303700130383037303600230333036303500430363301c006001375860680026068606600260660026eb4c0bc004dd698179817000802998131ba8375a605c0026604c6ea0dd698171816800812981780109980b00280198178009baa0024891c1c0d57fdad384c5192735d38e467629316ad06650dcd038d54aa15ed00488101410022223232323232323232323232323253330343370e900000109919299811191919299981c99b87480000084cc09cc0ec00401058c0f0008c0f0004dd5181c181c8040a9981119baf323039303a001303800b323039303a001303800a132323253330393370e9000001099baf3374a90001981980599819981d800998198050191980b804802899b8f3018303b303a303a00e005303c002303c00137540246eb0c0dc02cdd7181b0008b181b801181b8009baa30333032303200537586064606200c60626060606000460600026060010605e6602a0126eb0c0b800cc0b8cc02cc0b4c0b0010dd61816801980d9815800981500098159815000981500091198109129998120008b09919299981419b8f005375c002260580042600860520066058002601a60500020044646464a66604a66e1d20000021375c604e0022c605000460500026ea800488c8c8c94ccc094cdc3a400400426600c008604e0022c605000460500026ea800888cc078894ccc084004584c8c8c94ccc098cdd780300108008980298138021813981300118130009813181280080111299980f0008b099299980f800898118010b1810800a48100232323253330203370e9000001098110008b181180118118009baa001222333300437520040064666600a6ea4008dd5800bad14800052000223301922533301c00112250011533301e3375e6046604000200824460046048604400626004603e00200246466ec0c074004c074c070004c078dd50009180b111299980d000880109980199802001180f000980e80091299980c99b8800248000584cc00c008004c04c8894ccc064cdc3801240002603600226600666e040092002301a001223232323232323232323253330213370e90000010b0991919299981219b874800000854cc040cc048c098004c8dd61813980a000981398130068980c9980d180d9bae30260043301c20013758604c604a0182c604e004604e0026ea8c8c090c094004c08cc090030c090008c090004dd518101810800980f801180e800980f0009980a9bac301c0020013018301b301a002301b301a001301a0012233301600200100314a04602044a666026002294054ccc054cdd7980b8008018a511300230160012301330020012301230020012301130020012301030020012300f30020012300e300e00157464601044a666016002200c264a66601c60080022660100026006601e00426006601e004601e002446464646464a66602066e1d200000214a0266e3cdd71809000803980980118098009baa001300e300f001300d300e0012300622533300900110041330053003300d0013002300c0014bd702ba022330030010022300222533300500116153330073375e006646014601600260120022646014601260160026012002260046010002464600446600400400246004466004004002aae7c8c8c8c94ccc014cdc3a40040042600e0022c601000460100026ea80055cd2ba25742460046ea800555cf2ab9d010486d8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed7375820e650ce568d1dc1ebfb9bfbd8c06982f3ea95a9959ddaefc783edd95134d2b3ebffffd8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed73758200bee3eb0b93c2a1e72cb7937b90eac382666bd34dc5971df83f5ee4112a86a16ffffd8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed7375820e79dada966ab71401163d399134def8a608b31297e179782d796c76d434f8c57ffffd8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed73758204f0b13fa2716e773c279a0de67fe6fde1b665644e119f06589a6ae1e60c1d9c0ffffd8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed7375820e3b382a85249ef92357e00bd42c088c69c1eac2a736ae2df34dd2b89de11de1affffd8799fd8799fd8799f581c8acbfb7289d3d05d4b49d1e6b30800dce05417831f311d9a147edd72ffd8799fd8799fd8799f581cd1f49e87a64a43795769f80689500da406f063efe9c30648c684f7ceffffffff4100d8799f581c6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed7375820213117b6a9d5f387a75a5721e30cfc5ce0b544a12ff8ad1adda83065ca18956fffff0586840001d9050f9f00ff820000840002d9050f9f01ff820000840003d9050f9f02ff820000840004d9050f9f03ff820000840005d9050f9f04ff820000840006d9050f9f05ff820000f5f6',
  '84a90083825820165768bfc24efd9bb0b91555a03c4f454ba69f5792fa857f9bce3a619aaf0298018258208b0c34076d15d86fbe4daa3867a4bfc74041a73d4128fd939ac74c0d22e3477102825820b3a286377c550b2902a961cdfd26d5fa04131d82348d7c4e4b110d7670843708010184a300581d70a1640449d34fdfefc56868f0262eda2bebf91b33d1cda381dbfe3e2d01821a0014a67ca1581c8e97ba723d217adabf5f4d02b037b083ac9d3d8deb7576a061ffcd73a1414601028201d8185848d8799f5820cf78a117f9ee9a1aabd1e1498025a1c532fc2195cd00fffe6ee589766178043f5820f71f30fcc3ee067d25aa788580caa6ba74f558c60877b777bbddeb2f3b21a1efffa300581d70a1640449d34fdfefc56868f0262eda2bebf91b33d1cda381dbfe3e2d01821a0014a67ca1581c8e97ba723d217adabf5f4d02b037b083ac9d3d8deb7576a061ffcd73a1414601028201d8185848d8799f5820f71f30fcc3ee067d25aa788580caa6ba74f558c60877b777bbddeb2f3b21a1ef5820f9d604bef9cd4c78f8103e6a21af07d98a057243ca268916a865420e3771a159ffa300581d704cffc25c184b6b452b9de831da55a2b9677dc7a9b2c06b362e5ba3d801821a002dc6c0a3581c8e97ba723d217adabf5f4d02b037b083ac9d3d8deb7576a061ffcd73a2414c015820f71f30fcc3ee067d25aa788580caa6ba74f558c60877b777bbddeb2f3b21a1ef1b7ffffffffffff246581c95fd27df5f519c2d4bb971148c454ebe59f3b25ad4a78cc3078c0d64a158206aa1b1bd9f06cf9e6b9f495fb83bda85ef20eb3d3d61bfec912d680de5e888ea190457581c964b42f60fcece745b39d0010bfb8b6f7b4aee3ea8afce1df427c413a143534654192b67028201d81858a9d8799f581cc25f7962dcbb4f0837de40ab625f5df72a01f23a61eb4021ba6e8ad0581c95fd27df5f519c2d4bb971148c454ebe59f3b25ad4a78cc3078c0d6458206aa1b1bd9f06cf9e6b9f495fb83bda85ef20eb3d3d61bfec912d680de5e888ea581c964b42f60fcece745b39d0010bfb8b6f7b4aee3ea8afce1df427c41343534654181e0500001927101a001e84801b000001921fcec2e8000000000000d87a80d87a80d87980ff82583900b47c7c0ca235a188003fde3e6a583141a89125f346572bb87e81a8702966ddf1dacf046d52483389174713c212a3b549370f996066569251821a00786a08b1581c8e97ba723d217adabf5f4d02b037b083ac9d3d8deb7576a061ffcd73a3582092157bd4ebf2b1cdc45bc66eea335b67df5208d04dfb20ca62caf93d26f1cb2e1a001edfae5820f71f30fcc3ee067d25aa788580caa6ba74f558c60877b777bbddeb2f3b21a1ef1909d15820f9d604bef9cd4c78f8103e6a21af07d98a057243ca268916a865420e3771a1591a43503f88581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea14974657374546f6b656e14581c91d430184cfe84797bc99dc66230ff9618e9ed332c65835f4eed42fba14654657374696b01581c940ec6594edfd6f56ed93604e98b38c9c93992c560816d24d65b36c2a144546573741a0096dc50581c94698f5522fdf65b58e5ca324e16ea39f827a4c3fa95cb3939fae9a9a149436170756363696e6f1a001730e9581c95fd27df5f519c2d4bb971148c454ebe59f3b25ad4a78cc3078c0d64a4582001f656cc66baec49ab36b1a583054a25299c58e4f15c2176c9ec1c43cb396d031a02c847f858202e896864f4c4f1748af1f6d892335260dee7bc2ea55a01702217b50b48c7b4551af95fd6a258206aa1b1bd9f06cf9e6b9f495fb83bda85ef20eb3d3d61bfec912d680de5e888ea1b00000002540bdbc158206dec680044d61e200d9ee4ed3b15e03e4d7b93b2b70ca83a643ffc566f23d8ba1a0215fb8e581c964b42f60fcece745b39d0010bfb8b6f7b4aee3ea8afce1df427c413a1435346541b00000027f1b97fbb581ca465391790543ecd0f9f769ea24afbfde07007baa782724735e085a8a14f74426967546f6b656e4e616d65303614581cb4a3e4f565620ad3dc3157325c0b31f9f72b5531ca674157fd294bbda141431864581cb99eca0fee474f93d221b00db2a72a465f7519dd1429f455044530d6a14454657374186f581ccc4cd8bb54a228108f4bd4234cdfe07ee5de2f0e4d9e406f320be67da141561864581ccfc398182e8197a6b39cf2db07a207866074dca9165c3c61c7972f5ea14f74426967546f6b656e4e616d65303514581ccfdff341e1f47450c9f3a347c6d6be2f2029c891a289fc041e8f956ea14f74426967546f6b656e4e616d65303714581cd2e5d6dd927372b34b5da66cc7bee5dffd01351a49ac007efc9cea2da14f74426967546f6b656e4e616d65303414581cd40ebd57f674645d5b1826bbbe3528280463cae8f82982586faa4592a14f74426967546f6b656e4e616d65313014581cdeaafd8ec753f8b2477b60123f04490d34d522b09cb91457bfa12f1ca1581ca0cb928c016db1e87647ad9e322b1ae58819d70bd6b4a2c2c68cbdd301581cfbaec8dd4d4405a4a42aec11ce5a0160c01e488f3918b082ccbab705ad5820037a0776810df0a8030260ca0294d81350b7f7eda419309718e3baa6b3504c8b195ec05820155ebbc33b258129048f8c8569ff8adf584f05e496110274f9b74bbfa996f2df1a001004e058202113580db6a843e10030e058e745438c31a0e5d82b440948f9bbfa4b12b70a33190d9058202ce0819d24cdc1546e7cbbacf5d2f6a4af2f612a2b557927a08e7b48bbbfdd3f19277e5820359a3775c98ebdf02ddba964ff0be32bfaafb4eb05355114055d8395112d2ece1909d1582044da9f788bef996b9adbefa7d3d9cbb616d7e8174a1ffaf320270db7bf561b051a005d881a58206e7feb28973523c446bf83368df0dcef1519c051554977ac06b0313d73123d0a1909d158207925128b3179d0942182dfa55147fe9f83a6ac9be22da485aec1638fb7ce8c771a006e6d2858209ae315d898d5603b20209946401789106c91ff05f0e2e21ff7dc5e7762f402c91a00afe7035820ab6854726b0139254b7e5c4831c87ac043a938fa3543b5eb0ce0906e122083e91a000ae2fa5820bba39ac3c71f44b263872b0873393e713cd0ce3270403534f4d0753ba9e2acbc1923285820e39dc957f6f85c8d6f2935cf8c8617cd1320929d5dfa0983a44d0fbb65e6b60c1906645820eba5b37b643cf120805a51e10c97ca854ea2e0e1beebab5c3dbdf576db919a7219023b021a0006a768031a0441f2f1081a0441e4e109a1581c8e97ba723d217adabf5f4d02b037b083ac9d3d8deb7576a061ffcd73a3414601414c015820f71f30fcc3ee067d25aa788580caa6ba74f558c60877b777bbddeb2f3b21a1ef1b7ffffffffffffc170b582026ab2900a4829381caf8f3598220338db4e3f14d6ddcab4e121fcbeed6d9d6d70d81825820a02a7f1a1c2931b34c5881e6a4f0249b24c2ad0849907053afb693a01d74103b001282825820c8c032c3240848848ccf6575baf5a6235d43594f495764e569f7c14c63ac916500825820c8c032c3240848848ccf6575baf5a6235d43594f495764e569f7c14c63ac916504a2008182582023db24dd4ec11a54e462d39ced6c1541ed727f8b6d2fe775cf6135f67f79d5eb5840aa603f422bb1bc50210f69b53f52b1c65eb317db382724349a24c36fdc4678043cd930bc8845cfe2ddab2d3194faf41e78c487847e297a99aa6f3f3b9f3a9b090582840000d8799fd87980581c95fd27df5f519c2d4bb971148c454ebe59f3b25ad4a78cc3078c0d6458206aa1b1bd9f06cf9e6b9f495fb83bda85ef20eb3d3d61bfec912d680de5e888ea581c964b42f60fcece745b39d0010bfb8b6f7b4aee3ea8afce1df427c41343534654ff821a000b41a41a0f28b7a6840100d87a808219b6e11a00f0a128f5f6',
]

describe('transaction', () => {
  test.each(transactions)(
    'should patse transaction from CBOR #%#',
    async (transactionCbor) => {
      const parsedTx = parseTransactionCbor(transactionCbor)
      const cborizedParsedTx = encode(cborizeTx(parsedTx)).toString('hex')
      expect(cborizedParsedTx).toEqual(transactionCbor)
    },
  )
})
